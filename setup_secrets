#!/bin/bash
if [ $# -ne 1 ]
then
	echo "NEED 1 argument - type e.g. book, desk"
	exit 1
fi
TYPE=$1

X=$(which minikube)
STATUS=$?
if [ $STATUS == 0 ]
then
  URL=$(minikube service mongodb --url | sed -e 's/^http:\/\///')
else
  Y=$(which k3s)
  STATUS=$?
  if [ $STATUS == 0 ]
  then
    URL=$(kubectl describe service/mongodb | grep ^Endpoints | awk '{print $2}')
  fi
fi
URL=mongodb.default.svc.cluster.local
echo -n "  ${TYPE}_connection_string: " 
echo $(echo "mongodb://reserver:assets@${URL}/${TYPE}" | base64 -w 100)
#echo $(echo "mongodb://reserver:assets@${URL}/${TYPE}" | base64)
# e.g. mongodb://reserver:assets@192.168.49.2:31572/book
